<!DOCTYPE html>
<div id="body-container">
    <div id="panel-container">
        <div class="left-panel">
            <div class="content">
                <h1>Random Forest Regression
                </h1>
                <p>
                    t's time to shift our gears from the linear simplicity to the ensemble complexity! Think of Random
                    Forest Regression like a weather forecast team instead of just one meteorologist. It's an ensemble
                    learning method that combines multiple decision trees (think of these as individual forecasts) to
                    make a more accurate and robust prediction. Each tree in the forest makes its own prediction, and
                    the final output is the average of all these predictions. This method helps in reducing overfitting
                    (too much reliance on the training data) and improves accuracy.
                </p>
                <p>
                    Unlike linear regression, which tries to find a straight line that best fits the data, Random Forest
                    can capture complex, nonlinear relationships between the features and the target variable. So, in
                    the context of our data - like the time series data of maximum temperature, mean temperature, and
                    others - Random Forest would analyze patterns over time, taking into account various lag features
                    and possibly even rolling averages to predict future conditions. This would be especially useful for
                    more volatile weather elements, such as precipitation, where straightforward linear predictions
                    might fall short. We'll preprocess our data to remove gaps and outliers. Let's plot some box plots
                    to find outliers.
                </p>
                <pre><code class="language-python">import pandas as pd
import plotly.graph_objects as go
df = pd.read_csv('data/madrid1.csv')
df['CET'] = pd.to_datetime(df['CET'])
df.drop(['GUSTMAX', 'CC', 'Events', 'Dew Point', 'VISMIN', 'VISMAX', 'VISMEAN'], axis=1, inplace=True)
df.set_index('CET', inplace=True)
df[['TMEAN','TMAX', 'TMIN', 'DEWMEAN', 'DEWMIN']] = df[['TMEAN','TMAX', 'TMIN', 'DEWMEAN', 'DEWMIN']].apply(lambda c: (c * 9/5) + 32)
                    df[['WINDMAX']] = df[['WINDMAX']].apply(lambda km: km * 0.621371)
                    df['PRCP'] = df['PRCP'].apply(lambda mm: mm * .0393701)
                    
fig = go.Figure()
for column in df.columns:
    fig.add_trace(go.Box(y=df[column], name=column))
                    
fig.update_layout(
title='Box Plots of all Data',
yaxis_title='Values',
showlegend=True
)
fig.show()</pre></code>
                <p>
                    Our outliers are the circles outside of the box minimum or maximum. This doesn't mean they are all
                    actually outliers. We have to use our best judgement. The Max Wind Speed outliers, considering that
                    this isn't a record of max gusts, look suspicious. We'll remove them. I'll leave it as a challenge
                    to you to find out if there's any gaps in your data in a clever way.
                </p>
                <span class="code-subtext">// Remove notable outliers and select data time range with no gaps for our
                    variables
                </span>
                <p>

                </p>
                <pre><code class="language-python">df = df[['TMIN', 'TMAX', 'TMEAN', 'DEWMEAN', 'HUMMEAN', 'MSLPMEAN', 'PRCP', 'VISMEAN', 'WINDMAX', 'WDD', 'CC']]
df = df[df['WINDMAX'] &lt;= 61]
df = df[df['MSLPMIN'] >= 970]
df = df["2008-01-01:"]
target = 'TMEAN'
predictors = df.drop(['TMAX', 'TMIN', 'TMEAN'], axis=1).columns
X = df[predictors]
y = df[target]
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=44)
model = RandomForestRegressor(n_estimators=100, random_state=42)
model.fit(X_train, y_train)
y_pred = model.predict(X_test)
# Calculate error metrics and plot by a graphing library of your choice
</pre></code>
                <p>
                    Let's start by doing what we did in the first section, and trying to predict a variable based on
                    others from the same day. We'll run the exact same test
                </p>
                <div class="button-container">
                    <button class=selector-button onclick="loadSection(2)">&lt;</button>
                    <button class=selector-button onclick="loadSection(4)">&gt;</button>
                </div>
            </div>
        </div>
        <div class="right-panel">
            <div class="content">
                <h1>Data Visualization</h1>
                <div class=iframe-wrapper>
                    <iframe id=graphFrame>
                    </iframe>
                </div>
                <div class="button-container">
                    <button class=selector-button id="graph-rf-left" onclick="loadPreviousGraph()">&lt;</button>
                    <button class=selector-button id="graph-rf-right" onclick="loadNextGraph()">&gt;</button>
                </div>
            </div>
        </div>
    </div>
</div>